<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">


<head th:replace="~{support/fragments/standard/layout/header::content}"></head>

<body>
	<div class="container-fluid">
		<div>
            <form class="form-inline my-2" method="post" th:action="@{/orders/search-form/search_product}">
                <input class="form-control mr-sm-2" name="keyword" placeholder="product name" required th:value="${keyword}"
                       type="search"/>
				<input type="submit" class="btn btn-outline-success" value="Search" />
			</form>
		</div>

		<div class="row">
			<th:block th:each="product : ${listProducts}">
				<div class="col">
					<div>
						<a href="" class="linkProduct" th:pid="${product.id}"> <img
                                height="150" th:src="@{${product.getImagePath()}}"> <br/>
							<b th:id="'pname' + ${product.id}">[[${product.shortName}]]</b>
						</a>
					</div>
				</div>
			</th:block>
		</div>
		<div th:replace="~{orders/modal_fragments::content}"></div>
        <nav th:replace="~{support/fragments/standard/table_fragments :: pagination}"></nav>
	</div>

	<script th:src="@{/js/common_form.js}"></script>

	<script type="text/javascript">
		$(document).ready(function () {
			handleLinkProduct();
		});

		function handleLinkProduct() {
			$(".linkProduct").on("click", function (e) {
				e.preventDefault();
				productId = $(this).attr("pid");
				productName = $("#pname" + productId).text();

				if (window.parent.isProductAlreadyAdded(productId)) {
					showWarningModal("The product '" + productName + "' was already added.");
				} else {
					window.parent.addProduct(productId, productName);
				}

			});
		}
	</script>
</body>

</html>